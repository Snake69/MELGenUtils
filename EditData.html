<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<link rel="shortcut icon" href="Include/favicon.ico">
<title>Create/Edit Family Data</title>

<style>
    * {
        text-align: center;
    }
    body {
        background-color: #ffffff;
    }
    .fieldset-auto-width {
         display: inline-block;
    }
</style>

</head>
<body>
<dialog id="dial1">
<span id="dial1span"></span>
<form method="dialog">
<button type="submit">OK</button>
</form>
</dialog>

<h1>Create/Edit Family Data</h1>
<span id="TitleDBName"></span>
<hr style="width:50%">

<h4> Here new data to import may be created, or data in the active Family DataBase may be added to or edited one family at a time. <br>
     You may use your favorite editor, or use a provided form. Any changes to the active Family DataBase will be made to the <br>
     plain text version of the data. After changing the active Family DataBase, 'Verify Family Data' from the Main Menu will need to <br>
     be (re)run in order to make full use of MELGenUtils. If creating new data to be imported, it will need to be imported and then <br>
     verified in order to make full use of MELGenUtils. <br>
<br> <br> </h4>

<button type="button" onclick='NewData()'>Create New Data to be Imported</button>
<br> <br>
<button disabled id="PTButton" type="button" onclick='EditDB()'>Add to or Edit Active Family DataBase</button>
<br> <br>

<br>
<hr style="width:50%">

<div hidden id="CreateDBForm">
<br> <br>
<h1>Create New Data</h1>
<h4>Fill in as much data as is known.</h4>
<form id="CreateDB" method="POST">
<input type="hidden" name="ORIGIN" value="CreateDB">

<br> <br>
<fieldset class="fieldset-auto-width">
<legend>Head of Family</legend>
<fieldset class="fieldset-auto-width">
First Name: <input type="text" name="HOFNameF">
<br> <br>
Middle Name: <input type="text" name="HOFNameM">
<br> <br>
Last Name: <input type="text" name="HOFNameL">
</fieldset>
<fieldset class="fieldset-auto-width">
Born: <input type="date" id = "HOFBornD"> &nbsp; in <input type="text" name="HOFBornP">
<br> <br>
Baptized: <input type="date" id = "HOFBaptD"> &nbsp; in <input type="text" name="HOFBaptP">
<br> <br>
Died: <input type="date" id = "HOFDiedD"> &nbsp; in <input type="text" name="HOFDiedP">
<br> <br>
Buried: <input type="date" id = "HOFBuriedD"> &nbsp; in <input type="text" name="HOFBuriedP">
</fieldset>
<br> <br>
<fieldset class="fieldset-auto-width">
Residence: <input type="date" id = "HOFResiD"> &nbsp; in <input type="text" name="HOFResiP">
<br> <br>
SSN: <input type="date" id = "HOFSSND"> &nbsp; in <input type="text" name="HOFSSNP">
<br> <br>
Retired: <input type="date" id = "HOFRetD"> &nbsp; in <input type="text" name="HOFRetP">
</fieldset>
</fieldset>

<br> <br> <br>

<button type="button" id="button" onclick='sendFormData2Node();'> Create DataBase for Importing </button>

<br> <br>
</form>
</div>

<script>
var DBType;
onload = function init() {
    const ws = new WebSocket('ws://localhost:3000/');
    ws.onopen = function() {
        ws.send("DBName");
        ws.onmessage = function(e) {
            if (e.data != -1)
                document.getElementById("TitleDBName").innerHTML = '(' + e.data + ')'; 

            ws.send("DBFormat");
            ws.onmessage = function(e) {
                if (e.data == 'G') {
                    var span = document.getElementById("dial1span");
                    var msg = "This function does not yet work with a Gedcom DataBase.<br> <br>";
                    const dialog1 = document.querySelector("#dial1");
                    span.innerHTML = msg;
                    dialog1.showModal();
                }
                DBType = e.data;
            }
        }
    }
}

window.addEventListener('message', (e) => {
    if (e.data.type === 'sse') {
        const sseEventType = e.data.sseEventType;

        if (sseEventType == "monitorweb-update")
            alert(e.data.message);
        if (sseEventType == "verify-progress-update")
            console.log(e.data.message);
    }
})

function NewData () {
    document.getElementById("CreateDBForm").style.display = 'block';
}

function EditDB () {

}

function sendFormData2Node () {

}

</script>

<iframe src="sse-handler.html" style="display: none;" id="sse-frame"></iframe>

</body>
</html>
